----------- SPATIAL_UNIT_GROUP TABLE POPULATION MADE by Paola on 10/09/2013 ----------------------------------------

-- insert State - LGA - Ward hierarchy

DELETE FROM cadastre.spatial_unit_group;

--------------- Country
INSERT INTO cadastre.spatial_unit_group( name,id, hierarchy_level, label,  change_user) SELECT distinct 'Nigeria','Nigeria', 0, 'Nigeria', 'test'
	FROM interim_data."LGA" WHERE (ST_GeometryN(the_geom, 1) IS NOT NULL);

--------------- State
INSERT INTO cadastre.spatial_unit_group( name,id, hierarchy_level, label,  change_user) SELECT distinct(state),(state), 1, (state), 'test'
	FROM interim_data."LGA" WHERE (ST_GeometryN(the_geom, 1) IS NOT NULL);

--------------- LGA
INSERT INTO cadastre.spatial_unit_group( id, hierarchy_level, label, name, geom, change_user) 
	SELECT state||'/'||lga, 2, lga, state||'/'||lga, ST_GeometryN(the_geom, 1), 'test'
	FROM interim_data."LGA" WHERE (ST_GeometryN(the_geom, 1) IS NOT NULL);

--------------- Wards
--- test the inconsistencies in the geometry
INSERT INTO cadastre.spatial_unit_group( id, hierarchy_level, label, name, geom, change_user, seq_nr)
select distinct(lga_group.name ||'/'|| w.ward_temp), 3, w.ward_temp, lga_group.name||'/'||w.ward_temp, ST_GeometryN(w.the_geom, 1), 'test', 0
from cadastre.spatial_unit_group as lga_group,  interim_data."Ward" as w 
where lga_group.hierarchy_level = 2 and st_intersects(lga_group.geom, st_pointonsurface(w.the_geom));

--------------- Sections
--- test the inconsistencies in the geometry
INSERT INTO cadastre.spatial_unit_group( id, hierarchy_level, label, name, geom, change_user, seq_nr)
select ward_group.name || '/' || s.gid, 4, s.gid, ward_group.name || '/' || s.gid, ST_GeometryN(s.the_geom, 1), 'test', 0
from cadastre.spatial_unit_group as ward_group,  interim_data."Section" as s 
where ward_group.hierarchy_level = 3 and st_intersects(ward_group.geom, st_pointonsurface(s.the_geom));




----------- SPATIAL_UNIT_GROUP_IN TABLE POPULATION ----------------------------------------

DELETE FROM cadastre.spatial_unit_in_group;


INSERT INTO cadastre.spatial_unit_in_group (spatial_unit_group_id, spatial_unit_id, change_user)
	SELECT cadastre.spatial_unit_group.id, cadastre.spatial_unit.id, 'test' FROM cadastre.spatial_unit, cadastre.spatial_unit_group
			WHERE cadastre.spatial_unit.label = cadastre.spatial_unit_group.label;


---the insert values for section polygons and section spatial unit group goes here 
--Added 24 September 2013
INSERT INTO cadastre.spatial_unit_group ( id, hierarchy_level, label, name, reference_point, geom) VALUES ('uuid_generate_v1()', 4, '1001', 'OD/AKR/AKR10/1', NULL, '0103000020777F000001000000050000007E792332B6A726412E39F3E1B97C2841D4647DBCC2A726411FDA9091F37C2841AA6E0678F3A82641C76A1BC99B7C2841219C40E1D7A826413B143AF4347C28417E792332B6A726412E39F3E1B97C2841');
INSERT INTO cadastre.spatial_unit_group ( id, hierarchy_level, label, name, reference_point, geom) VALUES ('uuid_generate_v1()', 4, '1002', 'OD/AKR/AKR10/2', NULL, '0103000020777F000001000000080000005C7535B4B8A7264186A868AA117D28416E58B342CAA7264112FF497F787D28413B52CE05CEA72641698D3878BD7D284131BDB0D0C3A82641E17C8080C77D2841BC1392A52AA92641698D3878BD7D2841996C0FB9F4A826419464368C9F7C2841F6686B3AC0A72641FDD5A213F67C28415C7535B4B8A7264186A868AA117D2841');
INSERT INTO cadastre.spatial_unit_group ( id, hierarchy_level, label, name, reference_point, geom) VALUES ('uuid_generate_v1()', 4, '1003', 'OD/AKR/AKR10/3', NULL, '0103000020777F0000010000000A0000004B54C5C4CCA726413787533BC17D2841A03F1F4FD9A72641F6C4A01C377E2841D4268B5BE8A7264182FC08C1B07E2841FA32B0557CA826415F360DA48D7E2841EC955BA4DBA82641D563470D727E284178EC3C7942A92641C39F42AF4D7E2841BB1392A52AA926413787533BC17D2841DBB2DD15CAA82641AE769B43CB7D28412E39959278A82641D07A89C1C87D28414B54C5C4CCA726413787533BC17D2841');
INSERT INTO cadastre.spatial_unit_group ( id, hierarchy_level, label, name, reference_point, geom) VALUES ('uuid_generate_v1()', 4, '1004', 'OD/AKR/AKR10/4', NULL, '0103000020777F00000100000011000000C324949CE9A726412CF23506B77E2841C68936AA47A8264146049BBDE27F28411D379ED379A82641E0164A74D77F2841C9EED8B7A5A826418A2BF0E9CA7F2841A8ACF8D8CDA82641241F2670D27F2841105C57C1FEA82641BE125CF6D97F2841990FA4272DA9264146049BBDE27F284157AA5C9A6AA9264146049BBDE27F2841D05BB2419AA9264113FEB580E67F28418DF66AB4D7A92641BE125CF6D97F284104431E4EA9A9264131DBF351607F2841F0BC0B515FA926410AEE4788B97E284112E072FF49A926416F577D93797E284145E6573C46A92641A19B5431507E28415383ACEDE6A82641D563470D727E28412FDC2901B1A82641094BB319817E2841C324949CE9A726412CF23506B77E2841');
INSERT INTO cadastre.spatial_unit_group ( id, hierarchy_level, label, name, reference_point, geom) VALUES ('uuid_generate_v1()', 4, '1005', 'OD/AKR/AKR10/5', NULL, '0103000020777F0000010000000E000000D68B2D6946A8264101FCBEC1E77F2841B60B5B2994A82641C2BD27E1A8802841576C6A3990A92641492B4B6A668028419FBA6F12FCA9264148693DCB408028417CF473F5D8A92641890C77B9DD7F2841CF5BB2419AA92641DFF7D043EA7F2841CE99A4A274A92641F0F9C702E97F2841990FA4272DA9264112FEB580E67F2841DC36F95315A926413402A4FEE37F2841A88D7FA8E0A82641AB106537DB7F2841A6CB7109BBA82641221F2670D27F2841EAF2C635A3A82641442314EECF7F28412D39959278A82641BC125CF6D97F2841D68B2D6946A8264101FCBEC1E77F2841');

--the insert values for the section polygons and section spatial_unit_group goes here
-- Added 24 October 2013 by Samuel Okoroafor
INSERT INTO cadastre.spatial_unit_group ( id, hierarchy_level, label, name, reference_point, geom) VALUES ('uuid_generate_v1()', 4, '1', '1', NULL, '0103000020777F0000010000001A000000B6760D35A3A8264133C4CE8CB28028415B6779DAB4A8264107E5AF0FDD802841C1DE411DCCA82641C9A1F0970F812841D35D548DDAA82641A6F421183681284138BAAA5ADBA82641834753985C8128412F885A5DDFA826415F7F12A36C812841E6DC66FDE8A82641CD0DB96D69812841D6AEAAED1DA926415E64A02D5681284158F2471356A926412602DB5241812841BF8482CB83A92641AF26721532812841AF56C6BBB8A92641DC2003081E8128418CA9F73BDFA9264164459ACA0E812841171FE55E13AA2641BF542E25FD80284134EBB94134AA2641758EC84FF080284158B3FA3624AA26414643E1FCC0802841298385590BAA264115DD87347B8028411F36C3E6F8A926411CD9F3464A8028411CE56C86B5A926411DF465BC60802841916F7F6381A926415E887B9471802841A2B8ADE862A92641B18031677A8028416009269B3BA92641FA46973C8780284116284E5018A92641E8E2F6418F80284142076DCDEDA8264169F0AF7C9A802841A52DDFAFC1A82641F22FB9B4A1802841DB59C09FA9A826410EE11B22AC802841B6760D35A3A8264133C4CE8CB2802841');
INSERT INTO cadastre.spatial_unit_group ( id, hierarchy_level, label, name, reference_point, geom) VALUES ('uuid_generate_v1()', 4, '3', '3', NULL, '0103000020777F00000100000012000000BE889D2BF5A92641E1422764F783284150E21C856EAA2641DD4D29F5318528414F8DF7F177AA26417B4E43A143852841A78F8D19BBAA2641BBA30C4641852841BEE734090AAB26413DA3C42233852841D39591D26BAB2641DD4D29F531852841C7EEF67FD3AB26413EF8E9B5298528410844C024D1AB264102F7B55D068528412899B740CBAB2641094ABB63C48428418A989D94B9AB26414F483FE8928428416D421632A3AB2641D59B8C115F842841B1EB74237BAB26419E4313990C84284175EA40CB57AB2641C840354EBB83284197945D7A48AB264187EB6BA9BD832841BEE734090AAB264145EC57DED28328416590794ED0AA264184ECFBEFD98328418D38767088AA26418397D65CE3832841BE889D2BF5A92641E1422764F7832841');
INSERT INTO cadastre.spatial_unit_group ( id, hierarchy_level, label, name, reference_point, geom) VALUES ('uuid_generate_v1()', 4, '1006', 'OD/AKR/AKR10/1006', NULL, '0103000020777F000001000000120000008AD10AA49DA82641F4B067C0B0802841FA9A497CE7A82641F1A272AC698128415A66C50E23A92641AD36845553812841DD67B8CC69A9264144F725833A8128413E33345FA5A926415B69CB0826812841FC793C1EDAA9264172DB708E11812841B0AF694D3AAA26412F0C7B87F2802841BDFA357DFDA92641B02E7BA346802841352259CFD0A92641644EAA0C5380284164A39C2A9FA9264184E728E8668028419324E0856DA92641CBF00F8F748028416D9E79F41FA92641B47E6A0989802841513FECB8FAA826410DC0059693802841B1F46985E2A82641E74F9DCA99802841C8660F0BCEA826419D0CC5839D802841A8CD902FBAA826411CBEC8DBA18028413EF1390DAAA826418837184EA98028418AD10AA49DA82641F4B067C0B0802841');
INSERT INTO cadastre.spatial_unit_group ( id, hierarchy_level, label, name, reference_point, geom) VALUES ('uuid_generate_v1()', 4, '1007', 'OD/AKR/AKR10/1007', NULL, '0103000020777F0000010000000B000000C2FA3420E9A82641BEE76B2C73812841ADE139FF7CA92641E34A75D8C8822841B958B5B518AA2641A4A9D36D7A8228412157256644AA26417FF2568168822841EA05F99C87AA26417BCB506C5E822841E45FA743BCAA26415714D47F4C822841582906EB3FAA264117485A11F980284188AB71CEA9A92641BB3FB15B2A812841A4932DD568A926418DBBDC0043812841F84DCA6023A92641EC6B40875A812841C2FA3420E9A82641BEE76B2C73812841');
INSERT INTO cadastre.spatial_unit_group ( id, hierarchy_level, label, name, reference_point, geom) VALUES ('uuid_generate_v1()', 4, '1008', 'OD/AKR/AKR10/1008', NULL, '0103000020777F000001000000080000000344915B80A92641E8717BEDD2822841A6BC9C61F0A92641D681EF58EE832841FB205D3571AA2641966102AADE832841FE49CCC1F8AA2641E4754DDCCD8328414112744151AB2641A02E5A18B48328413AC2FE9FBFAA264105D9823853822841EA0390250AAA2641ADF7DF978E8228410344915B80A92641E8717BEDD2822841');
INSERT INTO cadastre.spatial_unit_group ( id, hierarchy_level, label, name, reference_point, geom) VALUES ('uuid_generate_v1()', 4, '1009', 'OD/AKR/AKR10/1009', NULL, '0103000020777F0000010000000C00000043C54741F9A92641B4FE8424F383284143C54741F9A92641B4FE8424F3832841711896927FAA2641048DC8D9478528410ED1675FD5AB2641C39574A42D852841D380A115C6AB26411DBD7AB4B78428419EBC87C292AB26419065D67D3E842841AAD4E0AF4AAB2641E4E54EA2BD832841223FAB590BAB264108B5BF32D0832841E7D3031BCDAA26410E5C4D1EDB8328412F3C235294AA2641912F1494E08328419696634405AA264119AA68F5F083284143C54741F9A92641B4FE8424F3832841');
INSERT INTO cadastre.spatial_unit_group ( id, hierarchy_level, label, name, reference_point, geom) VALUES ('uuid_generate_v1()', 4, '1010', 'OD/AKR/AKR10/1010', NULL, '0103000020777F00000100000005000000757B45AFF5A82641B7D1559E0C84284174EEF3534AA92641959ED41165852841524FEC287DAA26417569562358852841739E0DCEE0A9264178CCB759E9832841757B45AFF5A82641B7D1559E0C842841');
INSERT INTO cadastre.spatial_unit_group ( id, hierarchy_level, label, name, reference_point, geom) VALUES ('uuid_generate_v1()', 4, '1011', 'OD/AKR/AKR10/1011', NULL, '0103000020777F00000100000007000000A7A0DDD7B8A82641AD445AB12A8328417400AD55F4A82641240F4545058428415BB7FD3232A926410A8EF306008428414C6576A67AA92641235F64F0F5832841F39F9C5DE1A92641BC9AA938E2832841B0880FEE76A92641C3FB5020DA822841A7A0DDD7B8A82641AD445AB12A832841');
INSERT INTO cadastre.spatial_unit_group ( id, hierarchy_level, label, name, reference_point, geom) VALUES ('uuid_generate_v1()', 4, '1012', 'OD/AKR/AKR10/1012', NULL, '0103000020777F000001000000060000005630D29156A82641076029169F8128413DB8C2B6B5A82641A07FEBA91B8328410541F25A73A926415BD82B3BD1822841C09932EC28A926410DF8A01F2382284170E40F32DDA8264178B560F46B8128415630D29156A82641076029169F812841');
